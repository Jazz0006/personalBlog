# T3A3: A Personal Blog Web APP

This web app provides 2 major functions:

- Write bolgs and view blogs of other users
- Record the products a user has bought, log the price and the warrenty expire date.

This web app includes below pages:

| Page | Function |
|------|----------|
| user sign up | For a new user to register its account |
| user login   | Existing user to login |
| user detail | Display detailed information of a single user |
| blog index   | List of blogs that visible to the current user |
| single blog page | Display the full content of a blog |
| write a blog | For the current user to write a new blog or edit an old blog |
| list of items | Show all the items belongs to the current user |
| item detail | Show the detailed information of a single item |
| item input | Record a new item |
| car detail | display or register car information |

### The entity relationship diagram:

![ERD](.\docs\personalBlog_ERD.png)

### Validations:

| Table | Field | validation |
|-------|------------|-------|
| Users |password | Length > 6 |
|       |email | format of an email address |
|       |user_name| cannot be empty |
| Blogs |blog_title|cannot be empty |
|       |blog_publicity| in [1, 2]  |
| Items |item_name|cannot be empty |
|       | warrenty_expire | greater than `bought_at` |
| Car   | service_period | in [1, 2] |
|       | next_service | greater than `bought_at` |

### Security Concerns

This web app utilises `flask-login` python package. Users will need to use their email address and submit a password to register. Users also need to pick a `user_name`, but this is not necessary to be user's real name, and this `user_name` will be available to all other users. However, users' email address are private information and will not be disclosed to any other users.

Password's hash value instead of the password text is saved in the database. In case of a data breach, users' password are still safe and will not be disclosed.

When publishing a blog, user can select the article to be public or private. A public article can be viewed by all users, while private articles will be available to those users who follow the author.

All queries in this web app is written in SQLAlchemy ORM and no raw SQL is utilized. As SQLAlchemy will quote the parameters passed to the query, sepcial characters such as semicolons or apostrophes will be escaped and will not have the effect as in raw SQL. This web app is safe from SQL injection.

### Professional Obligations

As a study/practise project, this web app is still in its early developing stage. 

The test structure needs to be updated so database is configured and testcases can have direct access to db object, this will encrease the effiency of setting testcases. The target is to setup the automatic test environment.

Once the automatic test environment are ready, testcases need to be added and new features can be added:

Testcases:
- Trigger all the validation error
- Follower and Followed relationships
- visibility affected by followed/unfollow

Features:
- Blog category
- Groupby functions on blog category
- Items category
- Groupby functions on items
- User avatar
- Collection of photos. (User upload pictures, slide show pictures)

### Setup Steps:

1. pip install -r requirements.txt
2. Setup database:
   
```SQL
CREATE DATABASE myblogdb;
CREATE USER mybloguser WITH PASSWORD 'myblog1';
GRANT ALL PRIVILEGES ON DATABASE myblogdb TO mybloguser;
```

3. example of `.env` file:

```
DB_USER = "mybloguser"
DB_PASS = "myblog1"
DB_NAME = "myblogdb"
DB_DOMAIN = "localhost:5432"
SECRET_KEY = "temporary_secret_key_for_development"
```

4. All flask command should run in `program` directory
5. Migrate the database
6. Fake data can be generated by `flask db-custom seed`
7. To dump the whole database into a txt file, use `flask db-custom dump`
